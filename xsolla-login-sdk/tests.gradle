def readVariable(variableName) {
    File localPropertiesFile = project.rootProject.file('local.properties')
    if (localPropertiesFile.exists()) {
        Properties properties = new Properties()
        properties.load(new FileInputStream(localPropertiesFile))
        return properties[variableName]
    } else {
        return System.getenv(variableName)
    }
}

tasks.register('setupTestVariables') {
    doLast {
        def loginProjectId = readVariable('TEST_LOGIN_PROJECT_ID')
        def loginOauthClientId = readVariable('TEST_LOGIN_OAUTH_CLIENT_ID')
        def loginUsername = readVariable('TEST_LOGIN_USERNAME')
        def loginPassword = readVariable('TEST_LOGIN_PASSWORD')
        def fileContent = """//Do not edit this file manually
package com.xsolla.android.login

const val projectId = "${loginProjectId}"
const val oauthClientId = ${loginOauthClientId}

const val username = "${loginUsername}"
const val password = "${loginPassword}"
"""
        File file = new File("xsolla-login-sdk/src/test/java/com/xsolla/android/login/SecureTestParams.kt")
        file.write fileContent
    }
}